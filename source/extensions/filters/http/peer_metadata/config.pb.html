---
title: io.istio.http.peer_metadata
layout: protoc-gen-docs
generator: protoc-gen-docs
number_of_entries: 6
---
<h2 id="Config">Config</h2>
<section>
<p>Peer metadata provider filter. This filter encapsulates the discovery of the
peer telemetry attributes for consumption by the telemetry filters.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="Config-downstream_discovery">
<td><div class="field"><div class="name"><code><a href="#Config-downstream_discovery">downstream_discovery</a></code></div>
<div class="type"><a href="#Config-DiscoveryMethod">DiscoveryMethod[]</a></div>
</div></td>
<td>
<p>The order of the derivation of the downstream peer metadata, in the precedence order.
First successful lookup wins.</p>

</td>
</tr>
<tr id="Config-upstream_discovery">
<td><div class="field"><div class="name"><code><a href="#Config-upstream_discovery">upstream_discovery</a></code></div>
<div class="type"><a href="#Config-DiscoveryMethod">DiscoveryMethod[]</a></div>
</div></td>
<td>
<p>The order of the derivation of the upstream peer metadata, in the precedence order.
First successful lookup wins.</p>

</td>
</tr>
<tr id="Config-downstream_propagation">
<td><div class="field"><div class="name"><code><a href="#Config-downstream_propagation">downstream_propagation</a></code></div>
<div class="type"><a href="#Config-PropagationMethod">PropagationMethod[]</a></div>
</div></td>
<td>
<p>Downstream injection of the metadata via a response header.</p>

</td>
</tr>
<tr id="Config-upstream_propagation">
<td><div class="field"><div class="name"><code><a href="#Config-upstream_propagation">upstream_propagation</a></code></div>
<div class="type"><a href="#Config-PropagationMethod">PropagationMethod[]</a></div>
</div></td>
<td>
<p>Upstream injection of the metadata via a request header.</p>

</td>
</tr>
<tr id="Config-shared_with_upstream">
<td><div class="field"><div class="name"><code><a href="#Config-shared_with_upstream">shared_with_upstream</a></code></div>
<div class="type">bool</div>
</div></td>
<td>
<p>True to enable sharing with the upstream.</p>

</td>
</tr>
<tr id="Config-additional_labels">
<td><div class="field"><div class="name"><code><a href="#Config-additional_labels">additional_labels</a></code></div>
<div class="type">string[]</div>
</div></td>
<td>
<p>Additional labels to be added to the peer metadata to help your understand the traffic.
e.g. <code>role</code>, <code>location</code> etc.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h3 id="Config-Baggage">Baggage</h3>
<section>
<p>DEPRECATED.
This method uses <code>baggage</code> header encoding.</p>

</section>
<h3 id="Config-WorkloadDiscovery">WorkloadDiscovery</h3>
<section>
<p>This method uses the workload metadata xDS. Requires that the bootstrap extension is enabled.
For downstream discovery, the remote address is the lookup key in xDS.
For upstream discovery:</p>
<ul>
<li>
<p>If the upstream host address is an IP, this IP is used as the lookup key;</p>
</li>
<li>
<p>If the upstream host address is internal, uses the
&ldquo;filter_metadata.tunnel.destination&rdquo; dynamic metadata value as the lookup key.</p>
</li>
</ul>

</section>
<h3 id="Config-IstioHeaders">IstioHeaders</h3>
<section>
<p>This method uses Istio HTTP metadata exchange headers, e.g. <code>x-envoy-peer-metadata</code>. Removes these headers if found.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="Config-IstioHeaders-skip_external_clusters">
<td><div class="field"><div class="name"><code><a href="#Config-IstioHeaders-skip_external_clusters">skip_external_clusters</a></code></div>
<div class="type">bool</div>
</div></td>
<td>
<p>Strip x-envoy-peer-metadata and x-envoy-peer-metadata-id headers on HTTP requests to services outside the mesh.
Detects upstream clusters with <code>istio</code> and <code>external</code> filter metadata fields</p>

</td>
</tr>
</tbody>
</table>
</section>
<h3 id="Config-DiscoveryMethod">DiscoveryMethod</h3>
<section>
<p>An exhaustive list of the derivation methods.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="Config-DiscoveryMethod-baggage" class="oneof oneof-start">
<td><div class="field"><div class="name"><code><a href="#Config-DiscoveryMethod-baggage">baggage</a></code></div>
<div class="type"><a href="#Config-Baggage">Baggage (oneof)</a></div>
</div></td>
<td>
</td>
</tr>
<tr id="Config-DiscoveryMethod-workload_discovery" class="oneof">
<td><div class="field"><div class="name"><code><a href="#Config-DiscoveryMethod-workload_discovery">workload_discovery</a></code></div>
<div class="type"><a href="#Config-WorkloadDiscovery">WorkloadDiscovery (oneof)</a></div>
</div></td>
<td>
</td>
</tr>
<tr id="Config-DiscoveryMethod-istio_headers" class="oneof">
<td><div class="field"><div class="name"><code><a href="#Config-DiscoveryMethod-istio_headers">istio_headers</a></code></div>
<div class="type"><a href="#Config-IstioHeaders">IstioHeaders (oneof)</a></div>
</div></td>
<td>
</td>
</tr>
</tbody>
</table>
</section>
<h3 id="Config-PropagationMethod">PropagationMethod</h3>
<section>
<p>An exhaustive list of the metadata propagation methods.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="Config-PropagationMethod-istio_headers" class="oneof oneof-start">
<td><div class="field"><div class="name"><code><a href="#Config-PropagationMethod-istio_headers">istio_headers</a></code></div>
<div class="type"><a href="#Config-IstioHeaders">IstioHeaders (oneof)</a></div>
</div></td>
<td>
</td>
</tr>
</tbody>
</table>
</section>
